---
import { VideoDocument } from '~/_types'
import Layout from '../layouts/Layout.astro';
import Card from '../components/Card.astro';
import sortBy from 'just-sort-by';
import { getEditionInfo, stripHtmlHeadings } from '~/utils';

const videos: VideoDocument[] = await Astro.glob('../editions/*.md');
const hasYoutubeEmbed = videos.some(video => Boolean(video.frontmatter.youtube));
---
<Layout title="#whiteboardtheweb" preconnectToYoutube={hasYoutubeEmbed}>
		<h1>#WhiteboardtheWeb</h1>
		<div class="list">
			{sortBy(videos, 'file').reverse().map(({ file, compiledContent, frontmatter, getHeadings }) => (
				<Card
					title={getHeadings().find(h => h.depth === 1)?.text}
					htmlBody={stripHtmlHeadings(compiledContent())} 
					url={`/${getEditionInfo(file)?.base ?? ''}`}
					{...frontmatter} />
			))}
		</div>
</Layout>

<style>

	h1 {
		margin: 2rem 0;
		font-size: var(--font-size-xxl) !important;
	}

	.list {
		display: flex;
		flex-direction: column;
		gap: 1rem;
	}
</style>
